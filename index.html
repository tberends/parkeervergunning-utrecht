<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=yes, maximum-scale=5" name="viewport">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Wachtlijst parkeervergunning Utrecht</title>
    <meta name="author" content="Thomas Berends">
    <meta content="Historie van de wachtlijst voor een parkeervergunning binnen de gemeente Utrecht" name="description">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css">
    <style>
        /* Modern CSS Reset en basis stijlen */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            min-height: 100vh;
        }
        
        .container-fluid {
            background: white;
            min-height: 100vh;
            padding: 0;
        }
        
        /* Header styling - Gemeente Utrecht huisstijl */
        .header {
            background: #e60028; /* Utrecht rood */
            color: white;
            padding: 2.5rem 0;
            margin: 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .logo {
            max-width: 180px;
            height: auto;
            filter: brightness(0) invert(1);
            margin-right: 2rem;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .header-text {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.1;
        }
        
        .subtitle {
            font-size: 1.2rem;
            font-weight: 400;
            opacity: 0.9;
            line-height: 1.2;
        }
        
        h2 {
            font-size: 2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 4px;
            background: #e60028; /* Utrecht rood */
            border-radius: 2px;
        }
        
        p {
            font-size: 1.1rem;
            color: #4a5568;
            margin-bottom: 1.5rem;
            line-height: 1.7;
        }
        
        /* Main content */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Wijk filter styling */
        .filter-section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #e60028; /* Utrecht rood accent */
        }
        
        .form-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .form-control {
            border: 2px solid #ddd;
            border-radius: 4px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
            min-height: 48px;
            width: 100%;
            max-width: 400px;
        }
        
        .form-control option {
            padding: 0.5rem;
            font-size: 1rem;
        }
        
        .form-control:focus {
            border-color: #e60028; /* Utrecht rood */
            box-shadow: 0 0 0 3px rgba(230, 0, 40, 0.1);
            background: white;
            outline: none;
        }
        
        /* Card styling */
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        .card-header {
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            padding: 1.25rem 1.5rem;
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #333;
            margin: 0;
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        /* Chart styling */
        canvas {
            max-height: 400px;
            width: 100%;
            border-radius: 10px;
        }
        
        /* Table styling */
        .table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 2rem;
            border: 1px solid #e9ecef;
        }
        
        .table {
            margin-bottom: 0;
        }
        
        .table thead th {
            background: #e60028; /* Utrecht rood */
            color: white;
            border: none;
            padding: 1rem;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .table tbody tr {
            transition: background-color 0.2s ease;
        }
        
        .table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .table tbody td {
            padding: 1rem;
            border-top: 1px solid #e9ecef;
            vertical-align: middle;
        }
        
        /* DataTables styling */
        .dataTables_wrapper {
            padding: 1.5rem;
        }
        
        .dataTables_filter input {
            border: 2px solid #ddd;
            border-radius: 4px;
            padding: 0.5rem 0.75rem;
            margin-left: 0.5rem;
        }
        
        .dataTables_filter input:focus {
            border-color: #e60028; /* Utrecht rood */
            box-shadow: 0 0 0 2px rgba(230, 0, 40, 0.1);
            outline: none;
        }
        
        .dataTables_length select {
            border: 2px solid #ddd;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
        }
        
        /* Links styling */
        a {
            color: #e60028; /* Utrecht rood */
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        a:hover {
            color: #b3001f; /* Donkerder rood */
            text-decoration: underline;
        }
        
        /* Footer styling */
        footer {
            margin-top: 3rem;
            padding: 2rem;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            text-align: center;
            color: #6c757d;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .container-fluid {
                padding: 0;
            }
            
            main {
                padding: 1rem;
            }
            
            .header {
                padding: 1.5rem 0;
            }
            
            .header-content {
                padding: 0 1rem;
            }
            
            .logo {
                max-width: 120px;
                margin-right: 1rem;
            }
            
            h1 {
                font-size: 1.8rem;
                flex-direction: column;
                align-items: center;
                text-align: center;
                gap: 0.5rem;
            }
            
            .main-title {
                font-size: 1.8rem;
                text-align: center;
            }
            
            .subtitle {
                font-size: 1rem;
                text-align: center;
            }
            
            h2 {
                font-size: 1.6rem;
                text-align: center;
            }
            
            h2::after {
                left: 50%;
                transform: translateX(-50%);
            }
            
            p {
                font-size: 1rem;
                text-align: center;
            }
            
            .filter-section {
                padding: 1rem;
                margin-bottom: 1.5rem;
            }
            
            .card-header {
                padding: 1rem;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            .card-title {
                font-size: 1.1rem;
            }
            
            canvas {
                max-height: 250px;
            }
            
            .table thead th,
            .table tbody td {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }
            
            .dataTables_wrapper {
                padding: 1rem;
            }
        }
        
        @media (max-width: 576px) {
            main {
                padding: 0.75rem;
            }
            
            .header {
                padding: 1rem 0;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            
            .logo {
                max-width: 100px;
                margin-right: 0.75rem;
            }
            
            h1 {
                font-size: 1.4rem;
                line-height: 1.3;
                gap: 0.25rem;
            }
            
            .main-title {
                font-size: 1.4rem;
            }
            
            .subtitle {
                font-size: 0.9rem;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            .filter-section {
                padding: 0.75rem;
            }
            
            .form-control {
                padding: 0.6rem 0.75rem;
                font-size: 0.95rem;
                min-height: 44px;
            }
            
            .card-header {
                padding: 0.75rem;
            }
            
            .card-body {
                padding: 0.75rem;
            }
            
            canvas {
                max-height: 200px;
            }
            
            .table thead th,
            .table tbody td {
                padding: 0.5rem 0.25rem;
                font-size: 0.8rem;
            }
            
            .dataTables_filter input {
                width: 100%;
                margin-top: 0.5rem;
                margin-left: 0;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.2rem;
            }
            
            .logo {
                max-width: 50px;
            }
            
            canvas {
                max-height: 180px;
            }
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <h1>
                    <img src="https://huisstijl.utrecht.nl/fileadmin/uploads/documenten/zz-huisstijl/logo/logo-gemeente-utrecht-nederlands-groot-1200.png" alt="Gemeente Utrecht Logo" class="logo">
                    <div class="header-text">
                        <div class="main-title">Wachtlijst Parkeervergunning</div>
                        <div class="subtitle">Gemeente Utrecht</div>
                    </div>
                </h1>
            </div>
        </div>
        
        <main>
            <p>De gemeente Utrecht hanteert een wachtlijst voor parkeervergunningen in verschillende wijken. Deze wachtlijst is openbaar en wordt regelmatig bijgewerkt
                via de <a href="https://www.utrecht.nl/wonen-en-leven/parkeren/parkeren-bewoner/wachtlijst-parkeervergunning">website</a>. 
                Deze tabel toont de historie van de wachtlijst voor alle wijken.
            </p>
            
            <!-- Filters -->
            <div class="filter-section">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="wijkFilter" class="form-label">Selecteer wijk</label>
                        <select id="wijkFilter" class="form-control">
                            <option value="Wittevrouwen" selected>Wittevrouwen</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="vergunningFilter" class="form-label">Selecteer type vergunning</label>
                        <select id="vergunningFilter" class="form-control" disabled>
                            <option value="">Eerst een wijk selecteren</option>
                        </select>
                    </div>
                </div>
            </div>
                <div class="table-container">
                    <div id="table-container"></div>
                </div>
                
                <!-- Charts sectie -->
                <div class="mt-5">
                    <h2>Trends en Ontwikkelingen</h2>
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Aantal aanmeldingen over tijd</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="aanmeldingenChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Wachttijd in dagen</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="aanmelddatumChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Overzicht van alle metrics</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="combinedChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <footer>
            <p>Code beschikbaar via <a href="https://github.com/tberends/parkeervergunning-utrecht">Github repository</a></p>
        </footer>
    </div>
    
    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.2.1/js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery.csv.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="js/csv_to_html_table.js"></script>

    <script>
        function format_link(link) {
            if (link)
                return "<a href='" + link + "' target='_blank'>" + link + "</a>";
            else return "";
        }

        // Functie om DataTable te initialiseren en referentie op te slaan
        function initDataTable() {
            CsvToHtmlTable.init({
                csv_path: "data/history.csv",
                element: "table-container",
                allow_download: true,
                csv_options: {
                    separator: ",",
                    delimiter: '"'
                },
                datatables_options: {
                    paging: false,
                    responsive: true,
                    scrollX: true,
                    autoWidth: false,
                    columnDefs: [
                        { responsivePriority: 1, targets: 0 },
                        { responsivePriority: 2, targets: 1 },
                        { responsivePriority: 3, targets: 2 }
                    ],
                    language: {
                        search: "Zoeken:",
                        info: "Toont _START_ tot _END_ van _TOTAL_ records",
                        infoEmpty: "Geen records gevonden",
                        infoFiltered: "(gefilterd uit _MAX_ totaal records)",
                        zeroRecords: "Geen overeenkomende records gevonden"
                    },
                    dom: '<"row"<"col-sm-12 col-md-6"f><"col-sm-12 col-md-6">>rt<"row"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7">>'
                },
                custom_formatting: [
                    [4, format_link]
                ]
            });
            
            // Wacht tot DataTable is geïnitialiseerd en sla referentie op
            setTimeout(function() {
                dataTable = $('#table-container-table').DataTable();
                // Filter initieel op Wittevrouwen (vergunning filter wordt later geladen)
                filterTable();
            }, 1000);
        }

        // Stel Chart.js standaard lettertype in voor consistentie
        Chart.defaults.font.family = "'Helvetica Neue', Helvetica, Arial, sans-serif";
        
        // Globale variabelen voor grafieken
        let allData = [];
        let currentCharts = [];
        let dataTable = null;
        
        // Functie om wijken te laden en dropdown te vullen
        function loadWijken() {
            $.get("data/history.csv", function(csvData) {
                const lines = csvData.trim().split('\n');
                const wijken = new Set();
                
                for (let i = 1; i < lines.length; i++) {
                    const row = lines[i].split(',');
                    if (row.length >= 2) {
                        wijken.add(row[1]); // Kolom 2 bevat de wijk
                    }
                }
                
                // Vul dropdown met wijken
                const wijkFilter = $('#wijkFilter');
                wijkFilter.empty();
                
                // Sorteer wijken alfabetisch
                const sortedWijken = Array.from(wijken).sort();
                
                sortedWijken.forEach(wijk => {
                    const selected = wijk === 'Wittevrouwen' ? 'selected' : '';
                    wijkFilter.append(`<option value="${wijk}" ${selected}>${wijk}</option>`);
                });
                
                // Laad alle data
                loadAllData();
                
                // Laad vergunning types voor de standaard geselecteerde wijk
                loadVergunningTypes('Wittevrouwen');
            });
        }
        
        // Functie om vergunning types te laden op basis van geselecteerde wijk
        function loadVergunningTypes(selectedWijk) {
            const vergunningTypes = new Set();
            
            // Filter data op geselecteerde wijk
            const filteredData = allData.filter(d => d.wijk === selectedWijk);
            
            // Verzamel unieke vergunning types
            filteredData.forEach(d => {
                vergunningTypes.add(d.wachtlijst_voor);
            });
            
            // Vul dropdown met vergunning types
            const vergunningFilter = $('#vergunningFilter');
            vergunningFilter.empty();
            
            if (vergunningTypes.size > 0) {
                vergunningFilter.prop('disabled', false);
                
                // Sorteer vergunning types alfabetisch
                const sortedVergunningTypes = Array.from(vergunningTypes).sort();
                
                // Voeg "Alle types" optie toe
                vergunningFilter.append('<option value="">Alle types</option>');
                
                sortedVergunningTypes.forEach(vergunning => {
                    vergunningFilter.append(`<option value="${vergunning}">${vergunning}</option>`);
                });
            } else {
                vergunningFilter.prop('disabled', true);
                vergunningFilter.append('<option value="">Geen data beschikbaar</option>');
            }
        }
        
        // Functie om alle data te laden
        function loadAllData() {
            $.get("data/history.csv", function(csvData) {
                console.log('CSV data loaded');
                const lines = csvData.trim().split('\n');
                allData = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const row = lines[i].split(',');
                    if (row.length >= 6) {
                        allData.push({
                            record: parseInt(row[0]),
                            wijk: row[1],
                            wachtlijst_voor: row[2],
                            bijgewerkt: row[3],
                            aantal_aanmeldingen: parseInt(row[4]),
                            aanmelddatum_eerstvolgende: row[5]
                        });
                    }
                }
                
                // Maak initiële grafieken
                createCharts();
            });
        }
        
        // Functie om tabel te filteren op wijk en vergunning type
        function filterTable() {
            const selectedWijk = $('#wijkFilter').val();
            const selectedVergunning = $('#vergunningFilter').val();
            
            if (dataTable) {
                // Filter de DataTable op kolom 1 (wijk kolom, index 1) en kolom 2 (vergunning type, index 2)
                dataTable.column(1).search(selectedWijk).draw();
                if (selectedVergunning) {
                    dataTable.column(2).search(selectedVergunning).draw();
                } else {
                    dataTable.column(2).search('').draw();
                }
            }
        }
        
        // Functie om grafieken te maken nadat de data is geladen
        function createCharts() {
            console.log('Starting chart creation...');
            
            // Filter data op geselecteerde wijk en vergunning type
            const selectedWijk = $('#wijkFilter').val();
            const selectedVergunning = $('#vergunningFilter').val();
            
            let filteredData = allData.filter(d => d.wijk === selectedWijk);
            
            // Filter ook op vergunning type als geselecteerd
            if (selectedVergunning) {
                filteredData = filteredData.filter(d => d.wachtlijst_voor === selectedVergunning);
            }
            
            if (filteredData.length === 0) {
                console.log('No data found for selected filters:', selectedWijk, selectedVergunning);
                return;
            }

            // Sorteer op record nummer
            filteredData.sort((a, b) => a.record - b.record);

            // Bereid data voor voor grafieken
            const labels = filteredData.map(d => d.bijgewerkt);
            const aanmeldingen = filteredData.map(d => d.aantal_aanmeldingen);
            
            // Converteer aanmelddatums naar dagen vanaf bijgewerkt datum voor visualisatie
            const aanmelddatums = filteredData.map(d => {
                // Parse aanmelddatum (DD-MM-YYYY)
                const aanmeldParts = d.aanmelddatum_eerstvolgende.split('-');
                const aanmeldDatum = new Date(parseInt(aanmeldParts[2]), parseInt(aanmeldParts[1]) - 1, parseInt(aanmeldParts[0]));
                
                // Parse bijgewerkt datum (bijvoorbeeld "12 december 2024")
                const maanden = {
                    'januari': 0, 'februari': 1, 'maart': 2, 'april': 3, 'mei': 4, 'juni': 5,
                    'juli': 6, 'augustus': 7, 'september': 8, 'oktober': 9, 'november': 10, 'december': 11
                };
                
                const bijgewerktParts = d.bijgewerkt.split(' ');
                const dag = parseInt(bijgewerktParts[0]);
                const maand = maanden[bijgewerktParts[1]];
                const jaar = parseInt(bijgewerktParts[2]);
                const bijgewerktDatum = new Date(jaar, maand, dag);
                
                // Bereken verschil in dagen (bijgewerkt - aanmelddatum)
                const diffTime = bijgewerktDatum - aanmeldDatum;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                return diffDays;
            });

            console.log('Data processed, creating charts...');

            // Vernietig bestaande grafieken
            currentCharts.forEach(chart => {
                if (chart) {
                    chart.destroy();
                }
            });
            currentCharts = [];

            // Grafiek 1: Aantal Aanmeldingen
            const ctx1 = document.getElementById('aanmeldingenChart').getContext('2d');
            const chart1 = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Aantal Aanmeldingen',
                        data: aanmeldingen,
                        borderColor: 'rgb(75, 192, 192)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Aantal Aanmeldingen'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Bijgewerkt op'
                            }
                        }
                    }
                }
            });
            currentCharts.push(chart1);

            // Grafiek 2: Wachttijd in dagen
            const ctx2 = document.getElementById('aanmelddatumChart').getContext('2d');
            const chart2 = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Wachttijd in dagen',
                        data: aanmelddatums,
                        borderColor: 'rgb(255, 99, 132)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Wachttijd in dagen'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Bijgewerkt op'
                            }
                        }
                    }
                }
            });
            currentCharts.push(chart2);

            // Grafiek 3: Gecombineerd overzicht
            const ctx3 = document.getElementById('combinedChart').getContext('2d');
            const chart3 = new Chart(ctx3, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Aantal Aanmeldingen',
                        data: aanmeldingen,
                        borderColor: 'rgb(75, 192, 192)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        yAxisID: 'y',
                        tension: 0.1
                    }, {
                        label: 'Wachttijd in dagen',
                        data: aanmelddatums,
                        borderColor: 'rgb(255, 99, 132)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        yAxisID: 'y1',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'Bijgewerkt op'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Aantal Aanmeldingen'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Wachttijd in dagen'
                            },
                            grid: {
                                drawOnChartArea: false,
                            }
                        }
                    }
                }
            });
            currentCharts.push(chart3);
            
            console.log('All charts created successfully!');
        }

        // Wacht tot de pagina geladen is en start dan de grafieken
        $(document).ready(function() {
            console.log('Document ready');
            // Initialiseer DataTable
            initDataTable();
            // Laad wijken en data
            loadWijken();
            
            // Event listener voor wijk filter
            $('#wijkFilter').on('change', function() {
                const selectedWijk = $(this).val();
                loadVergunningTypes(selectedWijk);
                filterTable();
                createCharts();
            });
            
            // Event listener voor vergunning filter
            $('#vergunningFilter').on('change', function() {
                filterTable();
                createCharts();
            });
        });
    </script>
</body>

</html>
